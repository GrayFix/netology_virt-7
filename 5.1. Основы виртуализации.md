# 5.1. Основы виртуализации

1. Основное отличие паравиртуализации от виртуализации на основе ОС.
    1. Паравиртуализация это полная виртуализация оборудования с частичным прямым пробросом некоторых ресурсов (обычно сеть и диск) внутрь отдельной виртуальной машины. У таких виртуальных машин имеется своя ОС. Использует больше ресурсов чем виртуализация на основе ОС. Можно жестко лимитировать использование ресурсов для ВМ.

    2. Виртуализация на основе ОС - технология использования изолированных процессов, образующих контейнер и окружения этого контейнера на основе одной ОС. Контейнер не имеет своей ОС и работает на хостовой. Ресурсы лимитируются через cgroups.

2. Варианты использования сервисов:
    1. Высоконагруженная база данных, чувствительная к отказу - для продуктива и получения максимальной производительности можно использовать только физический сервер.

    2. Различные Java-приложения. Думаю, можно условно поделить по нагрузке. Традиционно Java приложения потребляют много памяти, поэтому запускать их в контейнерах не целесообразно, только для тестов или какие-то небольшие программы с ожидаемым потреблением ресурсов. Думаю, можно запускать и на физическом сервере, и с использованием паравиртуализации. Паравиртуализация предпочтительнее из-за переносимости.

    3. Windows системы для использования Бухгалтерским отделом. Тут я больше за паравиртуализацию даже в случае использования 1С с MSSQL сервером (максимальную производительность этой связки сейчас можно получить только установкой на одном сервере с использованием доступа к MS SQL через Shared Memory). Бухгалтерские системы обычно требуют минимального простоя, дешево (относительно физического размещения) и эффективно разместить такие сервера в кластерах виртуализации.

    4. Системы, выполняющие высокопроизводительные расчеты на GPU. Любо физические сервера либо сервера с виртуализацией на основе ОС. Паравиртуализаций традиционно плохо работает с таким типом задач. Если требуется разместить 1-2 высоконагруженные системы лучше разместить их на физическом сервере. Если систем много, и они часто изменяются лучше использовать виртуализацию на основе ОС.

3. Две системы паравиртуализации или полной виртуализации лучше не ставить. В лучшем случае, они будут друг другу мешать и не получится получить нормальную производительность. В худшем случае они не просто не будут работать. Вложенную виртуализацию на основе паравиртуализации или полной виртуализации тоже лучше лучше не использовать, будет слишком большая потеря производительности. Единственный приемлемый вариант использования - использовать виртуализацию на основе ОС внутри паравиртуализации. Например, Docker сервер внутри виртуалки VMWare/Hyper-V.

# Дополнение к 1 вопросу
Вопрос не совсем понятен. Если спрашивается чем паравиртуализация отличается от полной виртуализации, то полная виртуализация предполагает что окружение ВМ полностью эмулируется, и все доступы к ресурсам идут через гипервизор. При использовании паравиртуализации ВМ могут обращаться к некоторым ресурсам хостовой машины напрямую, минуя гипервизор.
